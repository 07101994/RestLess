# DoLess.Rest

**DoLess.Rest** is another type-safe REST API client library.
It is heavily inspired by [Refit](https://github.com/paulcbetts/refit), which is inspired by [Retrofit](http://square.github.io/retrofit), but does not works exactly the same way.

In fact **DoLess.Rest** is built by keeping in mind that reflection is slow. When we build beautiful apps we don't want them to be slow down because of an external library, that's why all the **DoLess.Rest** REST clients are fully generated during the compilation.

This library fully supports the uri template defined by the [RFC6570](http://tools.ietf.org/html/rfc6570) thanks to [DoLess.UriTemplates](https://github.com/letsar/DoLess.UriTemplates).

## How it works?

Install the NuGet package called DoLess.Rest and one of the extra package (like DoLess.Rest.Newtonsoft.Json) into your project.
A DoLess.Rest folder with a file named RestClient.g.dl.rest.cs will be inserted in your project.
This file will allow you to create the Rest client from your interface without relection.

As in Refit, you have to create an interface representing your REST API and use attributes to indicate what to do.
During the project compilation, all REST clients will be generated.

## Install

Available on NuGet.

Install DoLess.Rest

Install DoLess.Rest.Newtonsoft.Json (if you want to serialize/deserialize using Json.Net)

## Quick start

### 1°) Create your REST API interface

```csharp
[Header("User-Agent", "DoLess.Rest")]
public interface IGitHubApi
{
    [Get("users{/userId}")]
    Task<User> GetUserAsync(string userId);
}
```

### 2°) Get the actual REST client

```csharp
IGitHubApi gitHubApi = RestClient.For<IGitHubApi>("https://api.github.com");
```

### 3°) Make the call

```csharp
User user = await gitHubApi.GetUserAsync("lestar");
```

## REST client customization

You can change the way the API works with two things: The ```HttpClient``` that can be passed to the ```For``` method, or with the ```RestSettings```

### HttpClient

The ```For``` method accepts a ```HttpClient```, so you can initialize it with a ```HttpMessageHandler```.
With this, you can set default headers with a runtime value that will be the same accross all calls. You can also create a ```DelegatingHandler``` for authentification, an other one for logging, etc.

### RestSettings

These settings are used directly by the requests generated by **DoLess.Rest**.

You can set custom parameters or formatters.

#### Custom parameters

Custom parameters can be set at runtime but they are common to the entire REST client. These parameters can be used inside ```HeaderAttributes``` (set the ```isCustomParameter``` parameter to true) or inside the uri templates defined into the [HTTP Method attributes](#http-method-attributes)

#### MediaTypeFormatters

ddd

#### UrlParameterFormatters

#### FormFormatters




## Attributes

### HTTP Method attributes

In order to be identified as a REST interface, all methods of the interface must have a **HTTP Method attribute** that provides the request method and relative URL.

There are 8 built-in attributes: **Delete**, **Get**, **Head**, **Options**, **Patch**, **Post**, **Put** and **Trace**.
The relative URL of the resource must be specified as the argument of this attribute and it have to respect the [RFC6570 Uri template specification](http://tools.ietf.org/html/rfc6570).

*Note: You can use a literal string, or any expression (like a constant) as the argument.*

```csharp
[Get("/users{/userId}")]
[Get("/users{?since}")]
```

### Uri Template prefix & suffix attributes

If the REST api always starts with a common string, let's say a version number for example, you can put it into a ```UriTemplatePrefixAttribute```
Alternatively you can do the same if you REST api always ends with the same string, using the ```UriTemplateSuffixAttribute```

